<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
	<meta charset="UTF-8">
<title>Product Manager</title>
	<link  rel="stylesheet" th:href="@{/css/bootstrap.css}" type="text/css"/>
	<script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>`
	<script src="https://cdn.jsdelivr.net/npm/sockjs-client@1/dist/sockjs.min.js"></script>


	<script src="https://cdnjs.cloudflare.com/ajax/libs/stomp.js/2.3.3/stomp.min.js"></script>



</head>
<body>

<div class="container">
	<h1 style="text-align: center;margin: 10px">Product Manager</h1>
	<div  style="text-align: right;"><a href="new">Create New Product</a></div>


	<table class="table table-dark" >
		<thead>
		<tr>
			<th scope="col">Product ID</th>
			<th scope="col">Name</th>
			<th scope="col">Brand</th>
			<th scope="col">Made in</th>
			<th scope="col">Price</th>
			<th scope="col">Actions</th>
		</tr>
		</thead>
		<tbody>
		<tr th:each="product : ${listProducts}">
			<td th:text="${product.id}">Product ID</td>
			<td th:text="${product.name}">Name</td>
			<td th:text="${product.brand}">Brand</td>
			<td th:text="${product.madein}">Made in</td>
			<td th:text="${product.price}">Price</td>
			<td>
				<a th:href="@{'/edit/' + ${product.id}}">Edit</a>
				&nbsp;&nbsp;&nbsp;&nbsp;
				<a th:href="@{'/delete/' + ${product.id}}">Delete</a>
			</td>
		</tr>
		</tbody>
	</table>
</div>
<script>
	$(document).ready(function () {


		let socket;
		if (location.protocol === 'https:') {
			socket = new SockJS("https://localhost:3025/core/eip/notifications");
		} else {
			socket = new SockJS("http://localhost:3025/core/eip/notifications");
		}

		stompClient = Stomp.over(socket);
		const headers = {};
		stompClient.connect(headers, (frame) => {

			console.log('STOMP client Connected: ' + frame);

		const msisdn = '775808280';
		stompClient.subscribe(`/topic/${msisdn}/eip/notifications`, (data)=>alert(JSON.stringify(data.body)));
	})
	});
</script>
</body>
</html>